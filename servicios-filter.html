<!DOCTYPE html>
<html lang="es">

<head>
    <title>PaCuba - Servicios</title>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <!-- FontAwesome -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Google Fonts: Roboto -->
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="shortcut icon" href="icons/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="icons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="icons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="icons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="icons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="icons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="icons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="icons/apple-touch-icon-152x152.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon-180x180.png" />
    <!-- <link rel="manifest" href="site.webmanifest">  -->
    <!-- <meta http-equiv="refresh" content="10"> -->
    <style>
    </style>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-md navbar-light">
        <div class="container-fluid ">
            <div class="navbar-brand">
                <a href="index.html"><img src="img/logo.png" alt="pacuba" class="ms-1" /></a>
            </div>
            <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse"
                data-bs-target="#collapseNavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="navbar-collapse collapse fs-5" id="collapseNavbar">
                <ul class="navbar-nav">
                    <li class="nav-item text-light">
                        <a class="nav-link" href="index.html"><i class="fa-solid fa-house"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="servicios.html">Servicios</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="contacto.html">Contacto</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="ayuda.html">Ayuda</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="content-container">

        <h1>Servicios</h1>

        <form id="form-busqueda" class="mb-5">
            <!-- Tipo de Envío -->
            <div class="mb-3">
                <label class="form-label">Tipo de Envío</label>
                <div>
                    <input type="checkbox" name="type" value="piezas coche"> Piezas coche
                    <input type="checkbox" name="type" value="Portátil"> Portátil
                    <input type="checkbox" name="type" value="Móvil"> Móvil
                    <input type="checkbox" name="type" value="Calzado"> Calzado
                    <input type="checkbox" name="type" value="Medicamentos"> Medicamentos
                    <input type="checkbox" name="type" value="Alimentos"> Alimentos
                </div>
            </div>

            <!-- Caja de texto libre -->
            <div class="mb-3">
                <label class="form-label">Texto de búsqueda</label>
                <input type="text" class="form-control" id="texto-busqueda" placeholder="Buscar en todos los campos">
            </div>

            <!-- Prioridad -->
            <div class="mb-3">
                <label class="form-label">Prioridad</label>
                <div>
                    <input type="checkbox" name="priority" value="Normal"> Normal
                    <input type="checkbox" name="priority" value="Urgente"> Urgente
                </div>
            </div>

            <!-- Hasta (Kg) -->
            <div class="mb-3">
                <label class="form-label">Hasta (Kg)</label>
                <input type="number" class="form-control" id="hasta-kg" placeholder="Máximo peso en kg" min="1">
            </div>

            <!-- Destino -->
            <div class="mb-3">
                <label class="form-label">Destino</label>
                <select class="form-select" id="destino">
                    <option value="">Selecciona destino</option>
                    <option value="La Habana">La Habana</option>
                    <option value="Provincias">Provincias</option>
                </select>
            </div>

            <!-- Botones de acción -->
            <button type="button" class="btn btn-primary" onclick="aplicarFiltros()">Aplicar Filtros</button>
            <button type="button" class="btn btn-secondary" onclick="limpiarFiltros()">Limpiar Filtros</button>
        </form>

        <!-- Tabla de Resultados -->
        <h3>Resultados de la Búsqueda</h3>
        <table class="table table-bordered" id="tabla-resultados">
            <thead>
                <tr>
                    <th>Título</th>
                    <th>Descripción</th>
                    <th>Prioridad</th>
                    <th>Peso Máximo (Kg)</th>
                    <th>Tipos de Envío</th>
                    <th>Destino</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <a href="index.html" class="btn btn-info btn-primary float-end m-3" role="button">
            <i class="fa-solid fa-backward"></i> Volver
        </a>

    </div>

    <div id="cookie-banner"
        style="display:none; background-color: #333; color: white; padding: 15px; position: fixed; bottom: 47px; text-align: center;">
        Utilizamos cookies propias y de terceros para analizar nuestros servicios y mostrarte la información acorde a
        tus preferencias.
        Al hacer clic en "Aceptar todo", acepta el uso de TODAS las cookies. <a href="politica-de-cookies.htm"
            style="color: #4A90E2;">Leer más</a>.
        <button id="accept-cookies" onClick="hide('cookie-banner')"
            style="margin-left: 10px; padding: 5px 10px; background-color: #4A90E2; color: white; border: none; cursor: pointer;">
            Aceptar
        </button>
    </div>
    <footer>
        <div class="container footer-content">
            <div class="text-left scico">
                <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f fs-4"></i></a>
                <a href="#" aria-label="Twitter"><i class="fa-brands fa-x-twitter"></i></a>
            </div>

            <div class="footer-links  text-right">
                <a href="contacto.html">Contacta</a>
                <a href="nosotros.html">Nosotros</a>
            </div>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2E7PV4BMC4"></script>
    <script src="js/scripts.js"></script>
    <script>
        // Cargar los datos JSON desde el servidor
        let servicios = [];

        fetch('servicios.json') // Ruta a tu archivo JSON en el servidor
            .then(response => response.json())
            .then(data => {
                servicios = data; // Guardar los datos en la variable global
            })
            .catch(error => {
                console.error('Error al cargar el archivo JSON:', error);
            });

        // Función para aplicar filtros
        function aplicarFiltros() {
            // Obtener valores de los filtros
            const tiposSeleccionados = Array.from(document.querySelectorAll("input[name='type']:checked")).map(cb => cb.value);
            const textoBusqueda = document.getElementById("texto-busqueda").value.toLowerCase();
            const prioridadesSeleccionadas = Array.from(document.querySelectorAll("input[name='priority']:checked")).map(cb => cb.value);
            const hastaKg = document.getElementById("hasta-kg").value;
            const destino = document.getElementById("destino").value;

            // Filtrar los servicios
            const resultados = servicios.filter(servicio => {
                // Filtro por tipos de envío
                if (tiposSeleccionados.length > 0 && !tiposSeleccionados.some(tipo => servicio.types.includes(tipo))) return false;

                // Filtro por texto de búsqueda
                const textoEnCampos = `${servicio.title} ${servicio.desc} ${servicio.priority}`.toLowerCase();
                if (textoBusqueda && !textoEnCampos.includes(textoBusqueda)) return false;

                // Filtro por prioridad
                if (prioridadesSeleccionadas.length > 0 && !prioridadesSeleccionadas.includes(servicio.priority)) return false;

                // Filtro por peso máximo
                if (hastaKg && servicio.hasta_kg > Number(hastaKg)) return false;

                // Filtro por destino
                if (destino && !servicio.prices.some(price => price.hasOwnProperty(destino))) return false;

                return true;
            });

            mostrarResultados(resultados);
        }

        // Función para mostrar los resultados en la tabla
        function mostrarResultados(resultados) {
            const tablaResultados = document.querySelector("#tabla-resultados tbody");
            tablaResultados.innerHTML = ""; // Limpiar resultados previos

            resultados.forEach(servicio => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${servicio.title}</td>
                    <td>${servicio.desc}</td>
                    <td>${servicio.priority}</td>
                    <td>${servicio.hasta_kg}</td>
                    <td>${servicio.types.join(", ")}</td>
                    <td>${Object.keys(servicio.prices[0]).join(", ")}</td>
                `;
                tablaResultados.appendChild(row);
            });
        }

        // Función para limpiar los filtros
        function limpiarFiltros() {
            document.getElementById("form-busqueda").reset();
            document.querySelector("#tabla-resultados tbody").innerHTML = "";
        }
    </script>
</body>

</html>